<div class="wrapper">
  <h3>Network Settings</h3>

  <!--<ul class="nav nav-pills">
    <li class="active network-setup">
      <a href="#">Network Setup</a>
    </li>
    <li class="network-view">
      <a href="#">Network View</a>
    </li>
  </ul>-->

  <div class="network-tab-content">
    <% var disabled = cluster.task('deploy', 'running') ? 'disabled' : '' %>
    <fieldset>

      <div class="btn-group net-manager" data-toggle="buttons-radio">
        <% var managers = {'FlatDHCPManager': 'FlatDHCP Manager', 'VlanManager': 'VLAN Manager'} %>
        <% var net_manager = cluster.get('net_manager') %>
        <% _.each(_.keys(managers), function(manager) { %>
          <button type="button" data-manager="<%= manager %>" class="btn btn-primary <%= net_manager == manager ? 'active' : '' %>" <%= disabled %>><%= managers[manager] %></button>
        <% }) %>
      </div>

      <% if (networks.deferred.state() != 'pending') { %>
        <form class="form-inline networks-table" onsubmit="return false">

          <div class="row networks-header">
            <div class="network">Network</div>
            <div class="cidr">CIDR</div>
            <div class="vlan">VLAN ID</div>
          </div>

          <% var fixedNetwork %>
          <% networks.each(function(network) { %>
            <% if (network.get('name') != 'fixed') { %>
              <div class="row">
                <div class="control-group" data-network-name="<%- network.get('name') %>">
                  <div class="network-name"><%- network.get('name') %></div>
                  <div class="network-cidr">
                    <input class="input-medium" type="text" value="<%- network.get('cidr') %>" maxlength="18" <%= disabled %> />
                  </div>
                  <div class="network-amount hide">
                    <input class="input-mini" type="text" value="<%- network.get('amount') %>" />
                  </div>
                  <div class="network-size hide">
                    <select>
                      <option value="<%= network.get('network_size') %>" selected><%= network.get('network_size') %></option>
                    </select>
                  </div>
                  <div class="network-vlan">
                    <input class="input-mini" type="text" value="<%- network.get('vlan_start') %>" maxlength="4" <%= disabled %> />
                  </div>
                  <div class="network-error">
                    <span class="help-inline"></span>
                  </div>
                </div>
              </div>
            <% } else fixedNetwork = network %>
          <% }) %>

          <% if (fixedNetwork) { %>

            <% var vlan = net_manager == 'VlanManager' ? '' : 'hide' %>
            <% var range = net_manager == 'VlanManager' && fixedNetwork.get('amount') > 1 ? true : false %>

            <div class="row networks-header fixed-header">
              <div class="network">&nbsp;</div>
              <div class="cidr">CIDR</div>
              <div class="amount <%= vlan %>">Amount of networks</div>
              <div class="size <%= vlan %>">Size of network (IPs)</div>
              <div class="vlan"><%= range ? 'VLAN ID range' : 'VLAN ID' %></div>
            </div>

            <div class="row fixed-row">
              <div class="control-group" data-network-name="<%- fixedNetwork.get('name') %>">
                <div class="network-name">VM networks</div>
                <div class="network-cidr">
                  <input class="input-medium" type="text" value="<%- fixedNetwork.get('cidr') %>" maxlength="18" <%= disabled %> />
                </div>
                <div class="network-amount <%= vlan %>">
                  <input class="input-mini range" type="text" value="<%- fixedNetwork.get('amount') %>" maxlength="4" <%= disabled %> />
                </div>
                <div class="network-size <%= vlan %>">
                  <select <%= disabled %>>
                    <% var network_sizes = [4, 8, 16, 32, 64, 128, 256, 1024, 2048] %>
                    <% _.each(network_sizes, function(size) { %>
                      <option value="<%= size %>" <%= fixedNetwork.get('network_size') == size ? 'selected' : '' %>><%= size %></option>
                    <% }) %>
                  </select>
                </div>
                <div class="network-vlan">
                  <input class="input-mini <%= vlan ? '' : 'range' %>" type="text" value="<%- fixedNetwork.get('vlan_start') %>" maxlength="4" <%= disabled %> />
                  <% var vlan_end = fixedNetwork.get('vlan_start')+ fixedNetwork.get('amount') - 1 %>
                  <span class="network-vlan-end <%= range ? '' : 'hide' %>">-</span>
                  <input class="network-vlan-end input-mini <%= range  ? '' : 'hide' %>" type="text" value="<%= vlan_end %>" disabled />
                </div>
                <div class="network-error">
                  <span class="help-inline"></span>
                </div>
              </div>
            </div>
          <% } %>
        </form>
      <% } else { %>
        <div class="row row-fluid">
          <div class="span4"></div>
          <div class="span4">
            <div class="progress progress-striped progress-success active">
              <div class="bar" style="width: 100%"></div>
            </div>
          </div>
        </div>
      <% } %>
    </fieldset>
  </div>

<style>

.verification-router {
  display: block;
  width: 200px;
  height: 58px;
  position: relative;
  top: 4px;
  left: 190px;
  background: url(static/img/router.png) no-repeat top left;
}

.verification-node-1 {
  display: block;
  width: 140px;
  height: 40px;
  background-color:
  #dadada; position:
  relative;
  top: 60px;
  left: 0px;
}

.verification-node-2 {
  display: block;
  width: 140px;
  height: 40px;
  background-color: #cccccc;
  position: relative;
  top: 20px;
  left: 220px;
}

.verification-node-3 {
  display: block;
  width: 140px;
  height: 40px;
  background-color: #cccccc;
  position: relative;
  top: -20px;
  left: 440px;
}


.verification-node-1, .verification-node-2, .verification-node-3 {
  background: url(static/img/node-small.png) no-repeat top left;
}


.connect-1-stop, .connect-1-success, .connect-1-error  {
  display: block;
  width: 176px;
  height: 62px;
  position: relative;
  top: -122px;
  left: 62px;
  overflow: hidden;
}

.connect-1-stop {
  background: url(static/img/connect_1_anim.gif) no-repeat top left;
}

.connect-1-success {
  background: url(static/img/connect_1_anim.gif) no-repeat 0px -62px;
}

.connect-1-error {
  background: url(static/img/connect_1_anim.gif) no-repeat 0px -124px;
}

.connect-2-stop, .connect-2-success, .connect-2-error  {
  display: block;
  width: 8px;
  height: 62px;
  background-color: green;
  position: relative;
  top: -184px;
  left: 287px;
  overflow: hidden;
}

.connect-2-stop {
  background: url(static/img/connect_2_anim.gif) no-repeat top left;
}

.connect-2-success {
  background: url(static/img/connect_2_anim.gif) no-repeat 0px -62px;
}

.connect-2-error {
  background: url(static/img/connect_2_anim.gif) no-repeat 0px -124px;
}

.connect-3-stop, .connect-3-success, .connect-3-error  {
  display: block;
  width: 176px;
  height: 62px;
  position: relative;
  top: -246px;
  left: 345px;
  overflow: hidden;
}

.connect-3-stop {
  background: url(static/img/connect_3_anim.gif) no-repeat top left;
}

.connect-3-success {
  background: url(static/img/connect_3_anim.gif) no-repeat 0px -62px;
}

.connect-3-error {
  background: url(static/img/connect_3_anim.gif) no-repeat 0px -124px;
}

</style>

  <!-- network scheme -->
  <div class="row">
    <div class="page-control-box">
      <div style="display: block; margin: 10px 20px 10px 20px;">

        <div style="display: block; float: left; width: 580px; height: 172px; margin-right: 20px; position: relative;">

            <div class="verification-router"></div>

            <div  class="verification-node-1"></div>

            <div  class="verification-node-2"></div>

             <div  class="verification-node-3"></div>

            <div class="connect-1-success"></div>

            <div class="connect-2-success"></div>

            <div class="connect-3-error"></div>

        </div>


        <div style="display: block; float: left; width: 300px; overflow: hidden;">
            <li><strong>Network Verification is done in 3 steps:</strong></li>
            <li>1. Every node starts listening for test frames</li>
            <li>2. On every node via eth0 802.1Q tagget UDP frames are seat</li>
            <li>3. Listeners register test frames from other nodes</li>
            <div class="verify-network"></div>
        </div>
        
        <div style="clear: both;">

            <h4>Verification Test Result Table</h4>

            <table class="table table-condensed">
              <thead>
                <td>1</td>
                <td>2</td>
                <td>3</td>
              </thead>
              <tbody>
                <td>1</td>
                <td>2</td>
                <td>3</td>
              </tbody>
            </table>

        </div>

      </div>
    </div>
  </div>

  <!-- page-control box -->
  <div class="row">
    <div class="page-control-box">
      <div class="page-control-button-placeholder">
        <button class="btn btn-success apply-btn" disabled>Save Settings</button>
      </div>
      <div class="verify-network"></div>
    </div>
  </div>
</div>
